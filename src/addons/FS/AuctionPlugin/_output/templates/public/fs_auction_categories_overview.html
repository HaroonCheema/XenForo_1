<xf:title page="{$page}">{{ phrase('fs_auction_category') }}</xf:title>


<script>
//For Mulitiple counter

// For All OtherAuctions
function DateTimeConverter(unixdatetime) {
  var wStart_time = new Date(unixdatetime * 1000).toLocaleString("en-GB", {
    hour12: false,
    // timeZone:'Europe/London',
    timeStyle: "short",
  });
  var humanDate = new Date(unixdatetime * 1000);
  var year = humanDate.getFullYear();

  var month = (humanDate.getMonth() + 1).toString().padStart(2, "0");
  var date = humanDate.getDate();

  var fulldate = year + "-" + month + "-" + date + " " + wStart_time + ":00";

  // FormatingDateEspecialyForIOS
  var tempCountTimmer = fulldate.split(/[- :]/);
  // Apply each element to the Date function
  var tempDateObject = new Date(
    tempCountTimmer[0],
    tempCountTimmer[1] - 1,
    tempCountTimmer[2],
    tempCountTimmer[3],
    tempCountTimmer[4],
    tempCountTimmer[5]
  );
  var CountDownDateTime = new Date(tempDateObject).getTime();

  return CountDownDateTime;
}

function timmerCounter(auction_id, start_datetime) {
  let auc_id = auction_id;
	console.log(document.getElementById("hours-auction-" + auc_id));
  let humanDateTime = DateTimeConverter(start_datetime);

  var countDownDate = new Date(humanDateTime).getTime();
  var counter = setInterval(function () {
    // Get today's date and time
    var now = new Date().getTime();
    // Find the distance between now and the count down date
    var timeDistance = countDownDate - now;
    document.getElementById("days-auction-" + auc_id).innerHTML =
      Math.floor(timeDistance / (1000  60  60 * 24)) + " D";
    document.getElementById("hours-auction-" + auc_id).innerHTML =
      Math.floor((timeDistance % (1000  60  60  24)) / (1000  60 * 60)) +
      " H";
    document.getElementById("minutes-auction-" + auc_id).innerHTML =
      Math.floor((timeDistance % (1000  60  60)) / (1000 * 60)) + " M";
    document.getElementById("seconds-auction-" + auc_id).innerHTML =
      Math.floor((timeDistance % (1000 * 60)) / 1000) + " S";

    // If the count down is over, write some text
    if (timeDistance < 0) {
      clearInterval(counter);
    //  var url = window.location.origin + "/classified/auction/" + auc_id;
 //     document.getElementById("days-" + auc_id).innerHTML =
  //      "<a href=" + url + ">Join</a>";
  //    document.getElementById("hours-" + auc_id).classList.add("d-none");
   //   document.getElementById("minutes-" + auc_id).classList.add("d-none");
   //   document.getElementById("seconds-" + auc_id).classList.add("d-none");
    }
  }, 1000);
}

</script>


<xf:page option="searchConstraints" value="{{ {
	phrase('z61_classifieds_listings'): {'search_type': 'classifieds_listing'}
} }}" />

<xf:pageaction if="$xf.visitor.canAddClassified() && $categories is not empty">
	<xf:button href="{{ link('auction/add') }}" class="button--cta" icon="write" overlay="true">{{ phrase('fs_auction_categories_add_listing...') }}</xf:button>
</xf:pageaction>

<xf:form action="{{ link($prefix . '/toggle') }}" class="block" ajax="true">

  <div class="block-container">

  <xf:if is="$data is not empty">
	<div class="block-body">
		
		<xf:if is="$xf.options.fs_auction_list_layout == 'list_view'">
				<xf:if is="$listings is not empty">
					<div class="structItemContainer">
						<xf:foreach loop="$listings" value="$listing">
							<xf:macro template="fs_auction_listing_list_macros" name="listing"
									  arg-listing="{$listing}" />
						</xf:foreach>
					</div>
					<xf:elseif is="$filters" />
					<div class="block-row">{{ phrase('z61_classifieds_there_no_listings_matching_your_filters') }}</div>
					<xf:else />
					<div class="block-row">{{ phrase('z61_classifieds_no_listings_have_been_created_yet') }}</div>
				</xf:if>
				</xf:if>
			
			
			<xf:datalist data-xf-init="responsive-data-list">
					
				<xf:macro
					name="table_list"
					arg-data="{$data}"
				  />


				   </xf:datalist>
				
		    
		</div>
       <xf:else />
			<div class="block-body block-row">{{ phrase('no_items_have_been_created_yet') }}</div>
		
       </xf:if>
    
 </div>

</xf:form>
<xf:macro
  name="table_list"
  arg-data="{$data}"
>
  <xf:datarow rowtype="header">
    <xf:cell> {{ phrase('fs_cell_bidding') }} </xf:cell>
    <xf:cell class="dataList-cell--min"></xf:cell>
	 <xf:cell class="dataList-cell--min"></xf:cell>
  </xf:datarow>
  <xf:foreach loop="{$data}" value="$value">
    <xf:datarow>
		
          <xf:cell> {$value.title} </xf:cell>
		
	<xf:action href="{{ link('auction/categories/edit', $value) }}" >{{ phrase('edit') }}</xf:action>
      <xf:delete
        href="{{ link('auction/categories/delete', $value) }}"
        overlay="true"
      />
    </xf:datarow>
  </xf:foreach>
</xf:macro>


<xf:page option="sideNavTitle">{{ phrase('categories') }}</xf:page>
<xf:sidenav>
	<xf:macro template="fs_auction_category_list_macros" name="simple_list_block"
		arg-categoryTree="{$categoryTree}" />

</xf:sidenav>

<xf:widgetpos id="classifieds_overview_sidenav" position="sidenav" />