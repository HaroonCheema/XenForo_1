<xf:title>{{$auction.title}}</xf:title>
<xf:pageaction if="$xf.visitor.user_id == $auction.User.user_id">
	<xf:button href="{{ link('auction/categories/delete', $auction) }}" overlay="true" class="button button--icon button--icon--edit" icon="delete">{{ phrase('delete') }}</xf:button>
	<xf:button href="{{ link('auction/categories/edit', $auction) }}" class="button button--icon button--icon--edit" icon="edit">{{ phrase('edit') }}</xf:button>
	<xf:if is="$auction.ends_on > $xf.time">
	<xf:button href="{{ link('auction/categories/bumping', $auction) }}" class="button button--icon button--icon--add" icon="add">{{ phrase('fs_auction_bumping') }}</xf:button>
	</xf:if>
</xf:pageaction>

	<xf:css src="message.less" />

<header class="message-attribution message-attribution--split" style="color: #8c8c8c; font-size: 12px; padding-bottom: 3px; border-bottom: 1px solid #c9c9c9;">
		<ul class="message-attribution-main listInline {$mainClass}">
			<li class="u-concealed">
				<a href="{{ link('threads/post', $thread, {'post_id': $post.post_id}) }}" rel="nofollow">
					<xf:date time="{{$auction.created_date}}" itemprop="datePublished" />
				</a>
			</li>
		</ul>
		<ul class="message-attribution-opposite message-attribution-opposite--list {$oppositeClass}">
				
		
			
			<li>
				<a href="{{ link('auction/'.{$auction.category_id}.'/'.{$auction.auction_id}).'/view-auction' }}"
					class="message-attribution-gadget"
					data-xf-init="share-tooltip"
					data-href="{{ link('auction/share', $auction) }}"
					aria-label="{{ phrase('share')|for_attr }}"
					rel="nofollow">
					<xf:fa icon="fa-share-alt"/>
				</a>
			</li>
			
				<li>	
						<xf:macro template="fs_auction_bookmark_macros" name="link"
							arg-content="{$auction}"
							arg-class="message-attribution-gadget bookmarkLink--highlightable"
							arg-confirmUrl="{{ link('auction/bookmark', $auction) }}"
							arg-showText="{{ false }}"/>
				</li>
				<li>
					<a href="{{ link('auction', $auction, {'auction_id': $auction.auction_id}) }}" rel="nofollow">
						#{{ $auction.auction_id }}
					</a>
				</li>
		</ul>
	</header>
  <div style="margin-top:1rem">

		<div class="message-fields message-fields--after">
	
				<dl class="pairs pairs--columns pairs--fixedSmall pairs--customField" data-field="threadCustomField">
					<dt>{{ phrase('auction_endDate') }}</dt>
					
					<dd>
						{{date($auction.ends_on,'F j, Y')}}
					<!--	<xf:date time="{{$auction.ends_on}}" /> -->
					</dd>
				</dl>
			
		</div>

		<div class="message-fields message-fields--after">
	
				<dl class="pairs pairs--columns pairs--fixedSmall pairs--customField" data-field="threadCustomField">
					<dt>{{ phrase('auction_time_zone') }}</dt>
					<dd>{{$auction.timezone}}</dd>
				</dl>
			
		</div>

		<div class="message-fields message-fields--after">
	
				<dl class="pairs pairs--columns pairs--fixedSmall pairs--customField" data-field="threadCustomField">
					<dt>{{ phrase('starting_bid') }}</dt>
					<dd>{{$auction.starting_bid}} {{phrase('dollorSymbol')}}</dd>
				</dl>
			
		</div>

		<div class="message-fields message-fields--after">
	
				<dl class="pairs pairs--columns pairs--fixedSmall pairs--customField" data-field="threadCustomField">
					<dt>{{ phrase('bid_increments') }}</dt>
					<dd>{{$auction.bid_increament}}</dd>
				</dl>
			
		</div>

		<div class="message-fields message-fields--after">
	
				<dl class="pairs pairs--columns pairs--fixedSmall pairs--customField" data-field="threadCustomField">
					<dt>{{ phrase('payment_methods') }}</dt>
					<dd>
					<xf:foreach loop="$auction.payment_methods" value="$val">
						<p style="margin:0px;">{$val}</p>
        			</xf:foreach>
					</dd>
				</dl>
			
		</div>

		<div class="message-fields message-fields--after">
	
				<dl class="pairs pairs--columns pairs--fixedSmall pairs--customField" data-field="threadCustomField">
					<dt>{{ phrase('shippingTerms') }}</dt>
					<dd>{{ $auction.ShipTerm.shipping_term }}</dd>
				</dl>
			
		</div>

		<div class="message-fields message-fields--after">
	
				<dl class="pairs pairs--columns pairs--fixedSmall pairs--customField" data-field="threadCustomField">
					<dt>{{ phrase('shippingVia') }}</dt>
					<dd>{{ $auction.ShipVia.ship_via }}</dd>
				</dl>
		</div>
	  
	  <div class="message-fields message-fields--after">
	
				<dl class="pairs pairs--columns pairs--fixedSmall pairs--customField" data-field="threadCustomField">
					<dt>{{ phrase('guidlines') }}</dt>
					<dd>{{ phrase('auction_guidlines_explain') }}</dd>
				</dl>
			
		</div>


<br><br>
<div>
				<img src="{{$auction.getImage() ? $auction.getImage() : base_url('styles/FS/AuctionPlugin/no_image.png',true)}}" alt="{$attachment.filename}"
					width=" " style="width:-webkit-fill-available; width:-moz-available;" height="" loading="lazy" />
</div>

	   <div class="block-container">
		<div class="block-body">
				<xf:if is="count($bidding)">
						<h3 class="block-minorHeader"> {{phrase('fs_auction_top_bidding')}}</h3>

				  <xf:datalist data-xf-init="responsive-data-list"  style="border-bottom:1px solid #dfdfdf;">
					  <xf:datarow rowtype="header">
						<xf:cell> {{phrase('fs_auction_bidding_username')}} </xf:cell>
						<xf:cell> {{phrase('fs_auction_bid_at')}} </xf:cell>
						<xf:cell> {{phrase('fs_auction_bid_amount')}} </xf:cell>
					  </xf:datarow>
					<xf:datarow>
					  <xf:cell href="{{ link('members/', $bidding) }}"> {{$bidding.{$highestBidId}.User.username}} </xf:cell>
					  <xf:cell> <xf:date time="{{$bidding.{$highestBidId}.created_at}}" /></xf:cell>
					  <xf:cell> {{$bidding.{$highestBidId}.bidding_amount}} </xf:cell>
					</xf:datarow>
				</xf:datalist>


			</xf:if>
<xf:if is="$auction.ends_on > $xf.time AND $xf.visitor.user_id != 0">
		<xf:if is="$xf.visitor.user_id != $auction.User.user_id">
			<xf:form
				  action="{{ link('auction/categories/bidding', $auction) }}"
				  ajax="true"
				  class="block"
				  data-xf-init="attachment-manager"
				>
				<xf:formrow 
					label="{{ phrase('BidCost') }}">
	
			<!--bidDropDownRange value is  bid dropdown List items count-->
	
					<xf:set var="$bidDropDownRange" value="{{range(0,$dropDownListLimit)}}" />
					

					<div class="inputChoices">
							<xf:radio name="use_biddingAmountTyp">
								<xf:option label="{{ phrase('auctionDropdownBid') }}">
									<xf:dependent>
										<!--sum value is  bid increament+bidstart -->
									<!--	<xf:set var="$sum" value="{{$auction.bid_increament+$auction.starting_bid}}" /> 
										<xf:set var="$tempSum" value="{{$auction.getMaxBid($auction.auction_id)  ? $auction.getMaxBid($auction.auction_id) : $auction.bid_increament+$auction.starting_bid}}" />-->
										<xf:set var="$tempSum" value="{{$bidding.{$highestBidId}.bidding_amount  ? $bidding.{$highestBidId}.bidding_amount : $auction.bid_increament+$auction.starting_bid}}" />

										<xf:set var="$sum" value="{{$tempSum}}" />
										

										<xf:select name="bidding_amount">
												<xf:foreach loop="$bidDropDownRange" key="$key" value="$val">
													<xf:option value="{{$sum+$bidIncrementFromDb}}">{{$sum+$bidIncrementFromDb}}</xf:option>
													<xf:set var="$sum" value="{{$sum+$auction.bid_increament}}" />
												</xf:foreach>
										 </xf:select>
									</xf:dependent>
								</xf:option>

								<xf:option label="{{ phrase('auctionCustomBid') }}" name="use_biddingAmountTyp">
									<xf:dependent>
										 <xf:numberbox name="bidding_amount" value="{{$tempSum}}" min="{{$tempSum}}" 			
										label="{{ phrase('auctionCustomBid') }}" />
									</xf:dependent>

								</xf:option>
							</xf:radio>
					</div>
	
		</xf:formrow>

			<xf:submitrow icon="save" sticky="true" />

		</xf:form>
	<xf:else />
		<div style="display:flex; justify-content: center; padding:0.7rem;">
				<span >{{phrase('auctionOwnerCanNotBid')}}</span>	
			</div>
	</xf:if>
	
<xf:else />
	<div style="display:flex; justify-content: center; padding:0.7rem;">
				<span >{{phrase('biddingNotAllowed')}}</span>	
			</div>
	
</xf:if>
		   </div>
	  </div>
</div>
<xf:if is="count($bidding)">
	<div class="block" style="margin-top:1rem;">
	  <div class="block-container">
		<div class="block-body">
		  <xf:datalist data-xf-init="responsive-data-list">
			  <xf:macro name="bidding_table_list" arg-bidding="{$bidding}" />
		  </xf:datalist>
		</div>
	  </div>
	</div>
</xf:if>


<xf:macro name="bidding_table_list" arg-bidding="{$bidding}">
  <xf:datarow rowtype="header">
    <xf:cell> {{phrase('fs_auction_bidding_username')}} </xf:cell>
    <xf:cell> {{phrase('fs_auction_bid_at')}} </xf:cell>
    <xf:cell> {{phrase('fs_auction_bid_amount')}} </xf:cell>
  </xf:datarow>
  <xf:foreach loop="{$bidding}" value="$val">
    <xf:datarow>
      <xf:cell href="{{ link('members/', $val) }}"> {{$val.User.username}} </xf:cell>
      <xf:cell> <xf:date time="{{$val.created_at}}" /></xf:cell>
      <xf:cell> {{$val.bidding_amount}} </xf:cell>
    </xf:datarow>
  </xf:foreach>
</xf:macro>